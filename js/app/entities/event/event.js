var extend=function(e,t){function n(){this.constructor=e}for(var r in t)hasProp.call(t,r)&&(e[r]=t[r]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e},hasProp={}.hasOwnProperty,slice=[].slice;define(["app/app","base.entities"],function(e,t){return e.module("Entities",function(e,t,n,r,s,o){var a;return e.Event=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return extend(t,e),t.prototype.localStorage=new n.LocalStorage("Eventes"),t.prototype.defaults={start_date:moment().toISOString()},t}(e.Model),e.EventsCollection=function(t){function r(){return r.__super__.constructor.apply(this,arguments)}return extend(r,t),r.prototype.model=e.Event,r.prototype.localStorage=new n.LocalStorage("Eventes"),r}(e.Collection),a={getEvents:function(){var t;return this.events||(this.events=(t=new e.EventsCollection,t.fetch(),t))},getEvent:function(e){var n;return n=t.reqres.request("event:entities"),n.get(e)},newEvent:function(e){var n;return null==e&&(e={}),n=t.reqres.request("event:entities"),new n.model(e)},saveEvent:function(e,n){var r;return null==n&&(n={}),n=o.defaults(n,{success:function(e){return function(n,r,s){return e.events&&e.events.add(n),t.navigate("/event",{trigger:!0})}}(this)}),r=t.reqres.request("event:entities"),r.create(e,n)},destroyEvent:function(e){return e.destroy()}},t.reqres.setHandler("event:entities",function(){var e;return e=1<=arguments.length?slice.call(arguments,0):[],a.getEvents.apply(a,e)}),t.reqres.setHandler("event:entity",function(){var e;return e=1<=arguments.length?slice.call(arguments,0):[],a.getEvent.apply(a,e)}),t.reqres.setHandler("event:entity:new",function(){var e;return e=1<=arguments.length?slice.call(arguments,0):[],a.newEvent.apply(a,e)}),t.commands.setHandler("event:save",function(){var e;return e=1<=arguments.length?slice.call(arguments,0):[],a.saveEvent.apply(a,e)}),t.commands.setHandler("event:destroy",function(){var e;return e=1<=arguments.length?slice.call(arguments,0):[],a.destroyEvent.apply(a,e)})})});